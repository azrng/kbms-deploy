import{_ as s}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o as l,c as r,a as e,b as a,d as t,e as o}from"./app-3c3dee46.js";const c={},d=o(`<h1 id="介绍" tabindex="-1"><a class="header-anchor" href="#介绍" aria-hidden="true">#</a> 介绍</h1><p>SELinux一共有三种状态。</p><ul><li>Enforcing：默认状态，强制启用，状态值是1</li><li>Permissive：宽容，大部分规则都放行，状态值是0</li><li>Disabled：禁用，不设置任何规则</li></ul><h1 id="操作" tabindex="-1"><a class="header-anchor" href="#操作" aria-hidden="true">#</a> 操作</h1><h2 id="关闭" tabindex="-1"><a class="header-anchor" href="#关闭" aria-hidden="true">#</a> 关闭</h2><p>先查询当前的状态</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code>getenforce
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>编辑配置文件/etc/selinux/config</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code>vim <span class="token operator">/</span>etc<span class="token operator">/</span>selinux<span class="token operator">/</span>config
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>修改selinux的值为disabled</p><figure><img src="https://cdn.jsdelivr.net/gh/azrng/file/blog202212132141354.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>重启服务器</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code>reboot
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="添加配置" tabindex="-1"><a class="header-anchor" href="#添加配置" aria-hidden="true">#</a> 添加配置</h2><p>演示将 Nginx 添加至 SELinux 的白名单，执行命令</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>yum install policycoreutils-python

sudo <span class="token function">cat</span> <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>log/audit/audit<span class="token punctuation">.</span>log <span class="token punctuation">|</span> grep nginx <span class="token punctuation">|</span> grep denied <span class="token punctuation">|</span> audit2allow <span class="token operator">-</span>M mynginx

sudo semodule <span class="token operator">-</span>i mynginx<span class="token punctuation">.</span>pp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里安装可能会报错Exiting on user cancel</p><p>这是yum的一个bug导致的问题。修改/usr/lib/python2.7/site-packages/urlgrabber/grabber.py.</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>vi <span class="token operator">/</span>usr/lib/python2<span class="token punctuation">.</span>7/site-packages/urlgrabber/grabber<span class="token punctuation">.</span>py
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://cdn.jsdelivr.net/gh/azrng/file/blog202212132141886.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>修改后</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token comment">#elif errcode == 42:</span>
<span class="token comment"># this is probably wrong but ultimately this is what happens</span>
<span class="token comment"># we have a legit http code and a pycurl &#39;writer failed&#39; code</span>
<span class="token comment"># which almost always means something aborted it from outside</span>
<span class="token comment"># since we cannot know what it is -I&#39;m banking on it being</span>
<span class="token comment"># a ctrl-c. XXXX - if there&#39;s a way of going back two raises to</span>
<span class="token comment"># figure out what aborted the pycurl process FIXME</span>
<span class="token comment">#    raise KeyboardInterrupt</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后以root用户运行如下命令升级：</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>yum clean metadata
yum clean all
yum upgrade
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>升级完成即可。</p><h1 id="参考资料" tabindex="-1"><a class="header-anchor" href="#参考资料" aria-hidden="true">#</a> 参考资料</h1>`,26),p={href:"https://www.cnblogs.com/liuxiaoji/p/9907984.html",target:"_blank",rel:"noopener noreferrer"};function u(m,h){const n=i("ExternalLinkIcon");return l(),r("div",null,[d,e("p",null,[a("添加SeLinux配置："),e("a",p,[a("https://www.cnblogs.com/liuxiaoji/p/9907984.html"),t(n)])])])}const b=s(c,[["render",u],["__file","selinux.html.vue"]]);export{b as default};
